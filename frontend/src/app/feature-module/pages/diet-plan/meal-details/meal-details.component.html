<!-- Breadcrumb -->
<div class="breadcrumb-bar">
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-12 text-center">
                <h2 class="breadcrumb-title fw-bold mb-2">Diet Planner</h2>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb justify-content-center mb-0">
                        <li class="breadcrumb-item"><a href="#"><i class="ti ti-home-2"></i> Home</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Meal Details</li>
                    </ol>
                </nav>
            </div>
        </div>
        <div class="breadcrumb-bg position-relative">
            <img src="assets/img/bg/breadcrumb-bg-01.png" class="breadcrumb-bg-1" alt="Background Image">
            <img src="assets/img/bg/breadcrumb-bg-02.png" class="breadcrumb-bg-2" alt="Background Image">
        </div>
    </div>
</div>
<!-- /Breadcrumb -->

<div class="content">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <!-- Main Info Card -->
                <div class="card shadow-sm mb-4">
                    <div class="card-body">
                        <div class="row">
                            <!-- Left Column - Image and Quick Stats -->
                            <div class="col-lg-5">
                                <div class="position-relative mb-4">
                                    <img [src]="meal?.imageUrl" [alt]="meal?.name"
                                        class="img-fluid rounded shadow w-100" style="border-radius: 12px; filter: brightness(0.95);">
                                    <div class="position-absolute top-0 end-0 p-3 d-flex gap-2">
                                        <span class="badge bg-info rounded-pill">
                                            <i class="ti ti-category me-1"></i>{{ meal?.mealType }}
                                        </span>
                                    </div>
                                </div>

                                <!-- Quick Actions -->
                                <div class="d-flex gap-2 mb-4">
                                    <button class="btn btn-outline-primary flex-grow-1">
                                        <i class="ti ti-heart me-2"></i>Add to Favorites
                                    </button>
                                    <a [href]="meal?.recipeUrl" target="_blank" class="btn btn-primary flex-grow-1">
                                        <i class="ti ti-book me-2"></i>View Recipe
                                    </a>
                                </div>

                                <!-- Basic Info Box -->
                                <div class="card bg-light border-0">
                                    <div class="card-body">
                                        <h6 class="mb-3">Basic Information</h6>
                                        <div class="info-list">
                                            <div class="d-flex align-items-center mb-2">
                                                <i class="ti ti-chef-hat text-primary me-2"></i>
                                                <span class="text-muted me-2">Source:</span>
                                                <span>{{ meal?.source }}</span>
                                            </div>
                                            <div class="d-flex align-items-center mb-2">
                                                <i class="ti ti-world text-primary me-2"></i>
                                                <span class="text-muted me-2">Cuisine:</span>
                                                <span>{{ meal?.cuisineTypes?.join(', ') || 'Not specified' }}</span>
                                            </div>
                                            <div class="d-flex align-items-center">
                                                <i class="ti ti-users text-primary me-2"></i>
                                                <span class="text-muted me-2">Servings:</span>
                                                <span>{{ meal?.servings || 4 }} portions</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Right Column - Details -->
                            <div class="col-lg-7">
                                <h3 class="mb-4">{{ meal?.name }}</h3>
                                <!-- Source & Time -->
                                <div class="d-flex align-items-center text-muted mb-4">
                                    <i class="ti ti-chef-hat me-2"></i>
                                    <span>{{ meal?.sourceUrl }}</span>
                                    <span class="mx-2">•</span>
                                    <i class="ti ti-clock me-2"></i>
                                    <span>{{ meal?.cookTimeMinutes || '30 mins' }}</span>
                                </div>

                                <!-- Ingredients List -->
                                <div class="card bg-light border-0 mb-3">
                                    <div class="card-body">
                                        <h6 class="card-title mb-2">
                                            <i class="ti ti-list text-primary me-2"></i>Ingredients
                                        </h6>
                                        <div class="row">
                                            <div *ngIf="(meal?.ingredients ?? []).length > 0; else noIngredients">
                                                <div class="col-md-6" *ngFor="let ingredient of meal?.ingredients">
                                                    <div class="d-flex align-items-center py-1">
                                                        <i class="ti ti-point text-primary me-2"></i>
                                                        <span>{{ ingredient }}</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <ng-template #noIngredients>
                                                <p class="text-muted mb-0">No ingredients available.</p>
                                            </ng-template>
                                        </div>
                                    </div>
                                </div>

                                <!-- Labels and Tags -->
                                <div class="mb-4">
                                    <h6 class="mb-3">Diet & Health Labels</h6>
                                    <div class="mb-3">
                                        <span *ngFor="let label of meal?.dietLabels || []"
                                            class="badge bg-success me-2 mb-2">
                                            <i class="ti ti-check me-1"></i>{{ label }}
                                        </span>
                                    </div>
                                    <div>
                                        <span *ngFor="let label of meal?.healthLabels || []"
                                            class="badge bg-info me-2 mb-2">
                                            <i class="ti ti-heart me-1"></i>{{ label }}
                                        </span>
                                    </div>
                                </div>
<!-- Nutrition Facts Section -->
<div class="card">
    <div class="card-header bg-light">
      <h5 class="mb-0">
        <i class="ti ti-chart-pie text-primary me-2"></i>
        Complete Nutrition Facts
      </h5>
    </div>
    <div class="card-body">
      <div class="row g-2">
  
        <!-- Calories -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
          <div class="nutrition-stat bg-light-primary rounded p-2 text-center">
            <i class="ti ti-flame text-primary mb-1 fs-4"></i>
            <h6 class="small">Calories</h6>
            <p class="mb-0 small">{{ meal?.calories?.toFixed(1) }} kcal</p>
          </div>
        </div>
  
        <!-- Protein -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
          <div class="nutrition-stat bg-light-success rounded p-2 text-center">
            <i class="ti ti-meat text-success mb-1 fs-4"></i>
            <h6 class="small">Protein</h6>
            <p class="mb-0 small">{{ meal?.protein?.toFixed(1) }} g</p>
          </div>
        </div>
  
        <!-- Carbs -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
          <div class="nutrition-stat bg-light-warning rounded p-2 text-center">
            <i class="ti ti-bread text-warning mb-1 fs-4"></i>
            <h6 class="small">Carbs</h6>
            <p class="mb-0 small">{{ meal?.carbs?.toFixed(1) }} g</p>
          </div>
        </div>
  
        <!-- Fat -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2">
          <div class="nutrition-stat bg-light-info rounded p-2 text-center">
            <i class="ti ti-bottle text-info mb-1 fs-4"></i>
            <h6 class="small">Fat</h6>
            <p class="mb-0 small">{{ meal?.fat?.toFixed(1) }} g</p>
          </div>
        </div>
  
        <!-- Fiber -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.fiber">
          <div class="nutrition-stat bg-light-secondary rounded p-2 text-center">
            <i class="ti ti-leaf text-secondary mb-1 fs-4"></i>
            <h6 class="small">Fiber</h6>
            <p class="mb-0 small">{{ meal?.fiber?.toFixed(1) }} g</p>
          </div>
        </div>
  
        <!-- Sugar -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.sugar">
          <div class="nutrition-stat bg-light-danger rounded p-2 text-center">
            <i class="ti ti-candy text-danger mb-1 fs-4"></i>
            <h6 class="small">Sugar</h6>
            <p class="mb-0 small">{{ meal?.sugar?.toFixed(1) }} g</p>
          </div>
        </div>
  
        <!-- Calcium -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.calcium">
          <div class="nutrition-stat bg-light-primary rounded p-2 text-center">
            <i class="ti ti-bone text-primary mb-1 fs-4"></i>
            <h6 class="small">Calcium</h6>
            <p class="mb-0 small">{{ meal?.calcium?.toFixed(1) }} mg</p>
          </div>
        </div>
  
        <!-- Iron -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.iron">
          <div class="nutrition-stat bg-light-success rounded p-2 text-center">
            <i class="ti ti-droplet text-danger mb-1 fs-4"></i> 
            <h6 class="small">Iron</h6>
            <p class="mb-0 small">{{ meal?.iron?.toFixed(1) }} mg</p>
          </div>
        </div>
  
        <!-- Magnesium -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.magnesium">
          <div class="nutrition-stat bg-light-warning rounded p-2 text-center">
            <i class="ti ti-atom-2 text-warning mb-1 fs-4"></i>
            <h6 class="small">Magnesium</h6>
            <p class="mb-0 small">{{ meal?.magnesium?.toFixed(1) }} mg</p>
          </div>
        </div>
  
        <!-- Potassium -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.potassium">
          <div class="nutrition-stat bg-light-info rounded p-2 text-center">
            <i class="ti ti-droplet text-info mb-1 fs-4"></i>
            <h6 class="small">Potassium</h6>
            <p class="mb-0 small">{{ meal?.potassium?.toFixed(1) }} mg</p>
          </div>
        </div>
  
        <!-- Sodium -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.sodium">
          <div class="nutrition-stat bg-light-secondary rounded p-2 text-center">
            <i class="ti ti-salt text-secondary mb-1 fs-4"></i>
            <h6 class="small">Sodium</h6>
            <p class="mb-0 small">{{ meal?.sodium?.toFixed(1) }} mg</p>
          </div>
        </div>
  
        <!-- Phosphorus -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.phosphorus">
          <div class="nutrition-stat bg-light-danger rounded p-2 text-center">
            <i class="ti ti-flask-2 text-warning mb-1 fs-4"></i> 
            <h6 class="small">Phosphorus</h6>
            <p class="mb-0 small">{{ meal?.phosphorus?.toFixed(1) }} mg</p>
          </div>
        </div>
  
        <!-- Zinc -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.zinc">
          <div class="nutrition-stat bg-light-primary rounded p-2 text-center">
            <i class="ti ti-flask-2 text-primary mb-1 fs-4"></i> 
            <h6 class="small">Zinc</h6>
            <p class="mb-0 small">{{ meal?.zinc?.toFixed(1) }} mg</p>
          </div>
        </div>
  
        <!-- Selenium -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.selenium">
          <div class="nutrition-stat bg-light-success rounded p-2 text-center">
            <i class="ti ti-diamond text-success mb-1 fs-4"></i>
            <h6 class="small">Selenium</h6>
            <p class="mb-0 small">{{ meal?.selenium?.toFixed(1) }} µg</p>
          </div>
        </div>
  
        <!-- Vitamin A -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.vitaminA">
          <div class="nutrition-stat bg-light-warning rounded p-2 text-center">
            <i class="ti ti-eye text-warning mb-1 fs-4"></i>
            <h6 class="small">Vitamin A</h6>
            <p class="mb-0 small">{{ meal?.vitaminA?.toFixed(1) }} IU</p>
          </div>
        </div>
  
        <!-- Vitamin C -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.vitaminC">
          <div class="nutrition-stat bg-light-info rounded p-2 text-center">
            <i class="ti ti-sun text-info mb-1 fs-4"></i>
            <h6 class="small">Vitamin C</h6>
            <p class="mb-0 small">{{ meal?.vitaminC?.toFixed(1) }} mg</p>
          </div>
        </div>
  
        <!-- Vitamin D -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.vitaminD">
          <div class="nutrition-stat bg-light-secondary rounded p-2 text-center">
            <i class="ti ti-sunrise text-secondary mb-1 fs-4"></i>
            <h6 class="small">Vitamin D</h6>
            <p class="mb-0 small">{{ meal?.vitaminD?.toFixed(1) }} IU</p>
          </div>
        </div>
  
        <!-- Vitamin E -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.vitaminE">
          <div class="nutrition-stat bg-light-dark rounded p-2 text-center">
            <i class="ti ti-shield-half text-dark mb-1 fs-4"></i> 
            <h6 class="small">Vitamin E</h6>
            <p class="mb-0 small">{{ meal?.vitaminE?.toFixed(1) }} mg</p>
          </div>
        </div>
  
        <!-- Vitamin K -->
        <div class="col-6 col-md-4 col-lg-3 col-xl-2" *ngIf="meal?.vitaminK">
          <div class="nutrition-stat bg-light rounded p-2 text-center">
            <i class="ti ti-blood text-dark mb-1 fs-4"></i> 
            <h6 class="small">Vitamin K</h6>
            <p class="mb-0 small">{{ meal?.vitaminK?.toFixed(1) }} µg</p>
          </div>
        </div>
  
      </div>
    </div>
  </div>
  <!-- /Nutrition Facts Section -->
  

                            </div>
                        </div>
                    </div>
                </div>

                <!-- AI Section - Condensed -->
                <div *ngIf="meal; else loading">
                    <app-ai [plannedMeal]="meal"></app-ai>
                </div>
                <ng-template #loading>
                    <p>Loading meal details...</p>
                </ng-template>

            </div>
        </div>
    </div>
</div>